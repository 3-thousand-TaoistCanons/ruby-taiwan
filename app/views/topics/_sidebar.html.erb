<div class="sidebar">
<% if ["show","new","edit","node"].index(params[:action]) and !@node.blank? %>
  <div class="box">
    <h2><a href="<%= node_topics_path(@node) %>"><%= @node.name %></a></h2>
    <% if ["new"].index params[:action] %>
    <p class="sumamry">
      <%= @node.summary %>
    </p>
    <% end %>
    <div class="content">
      <a class="btn success" href="<%= new_topic_path(:node => @node.id) %>">发布新帖</a>
    </div>
  </div>
<% elsif ["index","recent"].include?(action_name) %>
  <div class="box" style="text-align:center;">
    <p>
      <a href="<%= new_topic_path %>" class="btn success">发布新帖</a>
    </p>
    <hr>
		<p>
			<a href="<%= feed_topics_url %>" title="用RSS阅读器订阅<%= Setting.app_name %>社区新贴">
				<%= image_tag('feed.png', :alt => "订阅#{Setting.app_name}社区新贴") %></a>
		</p>
  </div>
<% end %>

<%= cache("topic/init_list_sidebar/hot_nodes",:expires_in => 30.minutes) do %>
  <% if not @hot_nodes.blank? %>
  <div class="hot_nodes nodes box">
    <h2>热门节点</h2>
    <ul>
      <% @hot_nodes.each do |node| %>
        <li><a href="<%= node_topics_path(:id => node.id) %>"><%= node.name %></a></li>
      <% end %>
    </ul>
  </div>
  <% end %>
<% end %>

<% if ["new"].index(params[:action]) %>
  <div id="topic_new_tip" class="box">
    <h2>发贴说明</h2>
    <%= render "/shared/reply_help_block" %>
  </div>
<% end %>
<% if params[:action] == "index" %>
<div class="totals box">
	<h2>统计信息</h2>
	<ul>
		<li>社区会员: <%= User.count %> 人</li>
		<li>贴子数: <%= Topic.count %> 个</li>
		<li>回贴数: <%= Reply.count %> 条</li>
	</ul>
</div>
<% end %>
</div>
